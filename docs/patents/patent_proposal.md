# 医疗超适应症智能分析系统 - 专利申请技术交底书提案

基于本项目（Med-GraphRAG）的技术架构与创新实践，建议从以下两个核心维度进行专利布局：

---

## 专利提案一：一种融合知识图谱与大语言模型的超适应症用药分析方法

### 1. 发明名称
一种融合知识图谱与大语言模型的超适应症用药分析方法及系统

### 2. 技术领域
人工智能、医疗信息处理、临床决策支持系统 (CDSS)

### 3. 背景技术 & 痛点分析
*   **传统方法局限**：传统的超适应症检测主要依赖静态规则库或关键词匹配，难以应对医学知识的动态更新，且无法处理复杂的临床描述（如疾病的亚型、别名），容易产生漏判。
*   **纯大模型局限**：直接使用大语言模型（LLM）进行判断存在“幻觉”风险，医疗场景要求严谨，LLM 可能编造不存在的适应症，缺乏可解释性和安全性。
*   **现有技术缺口**：缺乏一种既能保证医疗规则严肃性（精确匹配），又能利用 AI 进行语义理解和机制推理（模糊关联）的混合架构。

### 4. 核心创新点
1.  **“神经-符号”双层耦合架构 (Neuro-Symbolic Architecture)**：
    *   创新性地构建了确定性逻辑与概率性推理相结合的双通道分析机制。**通道一（符号知识层）**基于结构化医学知识图谱（Indications KG）进行精确的知识锚定与逻辑校验，输出确定性结论；**通道二（神经推理层）**利用大模型基于药理机制图谱和海量医学文献进行语义泛化推理，输出建议性结论。
2.  **动态置信度融合算法**：
    *   设计了一种非线性的结果合成算法。当符号知识层完成精确锚定（非超适应症）时，系统优先采纳确定性证据，屏蔽神经推理层的潜在幻觉干扰；当符号层未命中（超适应症）时，自适应激活神经推理层的证据链分析（机制相似性、证据等级），为临床提供“合理性超适应症”的科学解释。
3.  **基于结构化映射的知识锚定技术**：
    *   提出了一种从非结构化药品说明书自动抽取并构建高精度知识图谱索引的方法，以此作为逻辑校验的“金标准”，解决了传统全文检索匹配精度低的问题。

### 5. 权利要求点拆解（Claims）

#### 独立权利要求
1.  一种融合知识图谱与大语言模型的超适应症用药分析方法，其特征在于，包括：
    *   **实体标准化步骤**：接收临床病例数据，识别并标准化其中的药品实体和疾病实体；
    *   **精准知识锚定步骤**：基于所述标准化药品实体，从预置的符号化医学知识图谱中检索结构化适应症约束，验证所述标准化疾病实体是否精确落在所述约束范围内，生成第一判定结果及确定性置信度；
    *   **神经语义推理步骤**：利用大语言模型，结合药理机制知识，分析所述药品实体与疾病实体之间的深层治疗相关性，生成第二判定结果及多维证据支持信息；
    *   **协同决策步骤**：根据确定性置信度对第一判定结果和第二判定结果进行自适应加权融合；若确定性置信度达到预设阈值，则优先输出第一判定结果；否则，综合输出第一判定结果及第二判定结果中的证据支持信息。

#### 从属权利要求
2.  根据权利要求 1 所述的方法，其特征在于，所述**结构化适应症列表**的构建过程包括：利用大语言模型从非结构化药品说明书中抽取疾病名称，并通过医学术语标准化映射，生成用于精确匹配的关键词序列。
3.  根据权利要求 1 所述的方法，其特征在于，所述**语义推理步骤**包括：计算药品作用机理与疾病病理机制的向量相似度，以及检索相关临床文献并评估证据等级（如指南、专家共识、RCT 研究）。
4.  根据权利要求 1 所述的方法，其特征在于，所述**协同决策步骤**还包括生成风险提示：当第一判定结果为超适应症且第二判定结果显示高机制相似性时，标记为“潜在合理超适应症”并提示监测不良反应。

---

## 专利提案二：一种基于多策略级联匹配的罕见病医疗实体识别与标准化方法

### 1. 发明名称
一种基于多策略级联匹配的罕见病医疗实体识别与标准化方法及装置

### 2. 技术领域
自然语言处理 (NLP)、知识图谱、医疗数据治理

### 3. 背景技术 & 痛点分析
*   **罕见病识别难**：罕见病名称复杂、别名众多（如“21-羟化酶缺乏症” vs “21-OHD”），且在通用语料中出现频率低，常规 NLP 模型识别率低。
*   **知识库对齐困难**：医疗实体存在严重的异构性，用户输入的非标准名称难以直接映射到知识库的标准 ID，导致后续分析失效。
*   **检索策略单一**：传统的模糊搜索容易引入噪声（误匹配），而严格匹配又容易导致漏检（Recall 低）。

### 4. 核心创新点
1.  **“生成-验证”双重实体链接范式**：
    *   摒弃传统的“抽取-分类”模式，采用“LLM 生成提取 + ES 结构化验证”的范式。利用 LLM 强大的语境理解能力处理输入文本的复杂性（纠错、别名识别），然后利用搜索引擎进行知识库的严格落地验证，解决了罕见病识别的“长尾”问题。
2.  **分层级联匹配策略 (Hierarchical Matching Strategy)**：
    *   设计了“精确 Term 匹配 -> 同义词 Synonym 匹配 -> 语义 Vector 匹配 -> LLM 原文回退”的四级级联策略。特别是针对罕见病建立白名单机制，强制进行高优先级的精确或同义词匹配，避免通用模糊搜索带来的误导。
3.  **异构知识融合索引技术**：
    *   构建包含标准名、通用名、商品名、临床俗称、罕见病代码（Orphanet ID）的多维索引结构，并结合倒排索引与向量索引，实现高精度的实体对齐。

### 5. 权利要求点拆解（Claims）

#### 独立权利要求
1.  一种面向罕见病场景的医疗实体识别与多策略知识库对齐方法，其特征在于，包括：
    *   **语义提取步骤**：利用大语言模型对非结构化医疗文本进行解析，提取候选实体名称及其上下文特征；
    *   **分层检索步骤**：将所述候选实体名称输入到多策略检索引擎中；首先执行基于关键词的精确匹配；若未命中，执行基于同义词词表的扩展匹配；若仍未命中，执行基于向量空间语义距离的模糊匹配；
    *   **罕见病增强步骤**：针对预设的罕见病实体库，配置高优先级的同义词映射规则，在检索过程中优先校验；
    *   **验证与标准化步骤**：根据检索匹配的得分与层级，确定目标标准实体 ID；若所有层级均未命中，则标记为新实体并保留原始提取名称作为临时标识。

#### 从属权利要求
2.  根据权利要求 1 所述的方法，其特征在于，所述**语义提取步骤**还包括：利用大语言模型的思维链（Chain of Thought）能力，自动识别并修正输入文本中的拼写错误或非标准简写。
3.  根据权利要求 1 所述的方法，其特征在于，所述**罕见病增强步骤**包括：构建包含 Orphanet ID 和多语言别名的稀疏索引，并配置禁止模糊纠错的过滤规则，以防止罕见病名称被错误纠正为常见病名称。
4.  根据权利要求 1 所述的方法，其特征在于，所述方法还包括**反馈学习机制**：记录未能匹配到标准 ID 的高频候选实体，经人工确认后自动更新至同义词词表或实体知识库中。

---

## 总结与建议

| 特性 | 专利一 (分析方法) | 专利二 (实体识别) |
| :--- | :--- | :--- |
| **侧重点** | 业务逻辑、决策流程、系统架构 | 数据处理、算法策略、底层技术 |
| **核心价值** | 解决临床应用中的“信任”与“安全”问题 | 解决数据治理中的“准确”与“召回”问题 |
| **易批性** | 强调流程创新和多技术融合，较容易通过 | 强调具体算法改进和特殊场景优化，技术深度更强 |
| **对应代码** | `engine.py`, `rule_checker.py`, `llm_reasoner.py` | `entity_matcher.py`, `drug_indexer.py`, ES Config |

建议优先申请**专利一**，因为其直接对应系统的核心业务价值（超适应症分析），保护范围较大；同时申请**专利二**作为底层技术支撑，构建完整的知识产权壁垒。
