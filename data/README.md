# æ•°æ®ç›®å½•è¯´æ˜

## ğŸ“ ç›®å½•ç»“æ„

```
data/
â”œâ”€â”€ raw/                           # åŸå§‹æ•°æ®ï¼ˆåªè¯»ï¼‰
â”‚   â”œâ”€â”€ drugs/                    # è¯å“åŸå§‹æ•°æ®
â”‚   â”‚   â””â”€â”€ processed_drugs.json  # ä»PostgreSQLå¤„ç†åçš„è¯å“æ•°æ®(1GB)
â”‚   â””â”€â”€ clinical_cases/           # ä¸´åºŠæ¡ˆä¾‹æ•°æ®
â”‚       â””â”€â”€ è¶…è¯´æ˜ä¹¦ç”¨è¯åˆ¤æ–­ç»“æœ-äººå·¥.csv
â”‚
â”œâ”€â”€ processed/                     # å¤„ç†åçš„æ•°æ®
â”‚   â”œâ”€â”€ diseases/                 # ç–¾ç—…æå–ç»“æœ
â”‚   â”‚   â””â”€â”€ diseases_search_after/ # LLMæå–çš„ç–¾ç—…æ•°æ®(æ‰¹æ¬¡æ–‡ä»¶)
â”‚   â””â”€â”€ states/                   # å¤„ç†çŠ¶æ€è®°å½•
â”‚       â””â”€â”€ extraction_states/    # ç–¾ç—…æå–ä»»åŠ¡çŠ¶æ€
â”‚
â”œâ”€â”€ cache/                         # ç¼“å­˜æ•°æ®ï¼ˆå¯æ¸…ç†ï¼‰
â”‚   â”œâ”€â”€ llm_responses/            # LLMå“åº”ç¼“å­˜
â”‚   â””â”€â”€ es_queries/               # ESæŸ¥è¯¢ç»“æœç¼“å­˜
â”‚
â””â”€â”€ exports/                       # å¯¼å‡ºç»“æœ
    â”œâ”€â”€ reports/                  # åˆ†ææŠ¥å‘Š
    â””â”€â”€ statistics/               # ç»Ÿè®¡æ•°æ®
```

## ğŸ“Š æ•°æ®è¯´æ˜

### raw/drugs/processed_drugs.json
- **å¤§å°**: ~1GB
- **å†…å®¹**: 85,923ä¸ªè¯å“çš„ç»“æ„åŒ–æ•°æ®
- **æ¥æº**: ä»PostgreSQLæå–ï¼Œç»è¿‡æ¸…æ´—å’Œæ ‡å‡†åŒ–
- **ç”¨é€”**: å¯¼å…¥Elasticsearchå»ºç«‹è¯å“çŸ¥è¯†å›¾è°±
- **æ ¼å¼**: JSONæ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ åŒ…å«å®Œæ•´çš„è¯å“ä¿¡æ¯

### processed/diseases/diseases_search_after/
- **å†…å®¹**: ç–¾ç—…æå–æ‰¹æ¬¡ç»“æœï¼ˆbatch_XXXXX.jsonï¼‰
- **æ‰¹æ¬¡æ•°**: çº¦342ä¸ªæ‰¹æ¬¡æ–‡ä»¶
- **å¤„ç†è¿›åº¦**: 68,220/85,923ä¸ªè¯å“ï¼ˆçº¦79.4%ï¼‰
- **è¯´æ˜**: ä½¿ç”¨LLMä»è¯å“é€‚åº”ç—‡ä¸­æå–çš„ç–¾ç—…å®ä½“
- **æ³¨æ„**: ç”±äºsearch_afteræ’åºé—®é¢˜ï¼Œæœªå®Œæˆå…¨éƒ¨æå–ï¼ˆå·²ä¿®å¤ï¼Œä¸‹æ¬¡è¿è¡Œå°†å®Œæ•´ï¼‰

### processed/states/extraction_states/
- **å†…å®¹**: extraction_search_after_state.json (2.7MB)
- **ç”¨é€”**: è®°å½•ç–¾ç—…æå–ä»»åŠ¡çš„è¯¦ç»†çŠ¶æ€
- **åŒ…å«ä¿¡æ¯**:
  - processed_count: å·²å¤„ç†è¯å“æ•°é‡
  - processed_drug_ids: å·²å¤„ç†çš„68,220ä¸ªè¯å“IDåˆ—è¡¨
  - success_count/failure_count: æˆåŠŸ/å¤±è´¥ç»Ÿè®¡
  - last_sort_value: search_afterçš„æœ€åä½ç½®
- **é‡è¦æ€§**: â­ é‡è¦å¤‡ä»½ï¼Œè®°å½•äº†å“ªäº›è¯å“å·²å¤„ç†

### raw/clinical_cases/
- **å†…å®¹**: ç½•è§ç—…ä¸´åºŠç”¨è¯æ•°æ®
- **æ ¼å¼**: CSVæ–‡ä»¶
- **ç”¨é€”**: æ‰¹é‡åˆ†ææµ‹è¯•æ•°æ®

## ğŸ”„ æ•°æ®æ›´æ–°æµç¨‹

### 1. è¯å“æ•°æ®æ›´æ–°
```bash
# ä»PostgreSQLé‡æ–°æå–
python -m app.pipeline.drug_etl --output data/raw/drugs/

# å¯¼å…¥Elasticsearch
python -m app.pipeline.drug_etl --load
```

### 2. ç–¾ç—…æ•°æ®æ›´æ–°
```bash
# ä»è¯å“é€‚åº”ç—‡æå–ç–¾ç—…
python tasks/extract_diseases_search_after.py --resume

# ç»“æœè‡ªåŠ¨ä¿å­˜åˆ°data/processed/diseases/
```

### 3. ç¼“å­˜ç®¡ç†
```bash
# æ¸…ç†ç¼“å­˜
rm -rf data/cache/*

# ç¼“å­˜ä¼šè‡ªåŠ¨é‡å»º
```

## ğŸ“ æ•°æ®å¤‡ä»½å»ºè®®

### é‡è¦æ•°æ®ï¼ˆå»ºè®®å¤‡ä»½ï¼‰
1. `data/raw/drugs/processed_drugs.json` - è¯å“åŸå§‹æ•°æ®
2. `data/processed/states/` - å¤„ç†çŠ¶æ€è®°å½•
3. `data/processed/diseases/` - ç–¾ç—…æå–ç»“æœ

### å¯æ¸…ç†æ•°æ®
1. `data/cache/` - ç¼“å­˜å¯é‡å»º
2. `data/exports/` - å¯¼å‡ºç»“æœå¯é‡æ–°ç”Ÿæˆ

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ä¸è¦æ‰‹åŠ¨ä¿®æ”¹raw/ç›®å½•**ï¼šåŸå§‹æ•°æ®åº”ä¿æŒåªè¯»
2. **å®šæœŸå¤‡ä»½states/**ï¼šè®°å½•äº†å¤„ç†è¿›åº¦ï¼Œä¸¢å¤±éœ€é‡æ–°å¤„ç†
3. **cache/å¯ä»¥å®‰å…¨åˆ é™¤**ï¼šæ‰€æœ‰ç¼“å­˜éƒ½ä¼šè‡ªåŠ¨é‡å»º
4. **exports/æŒ‰éœ€ä¿ç•™**ï¼šæ ¹æ®éœ€è¦å®šæœŸæ¸…ç†æ—§çš„å¯¼å‡ºæ–‡ä»¶

## ğŸ“ˆ æ•°æ®ç»Ÿè®¡

- **è¯å“æ€»æ•°**: 85,923
- **ç–¾ç—…å®ä½“**: ~5,000+ï¼ˆå¾…å®Œæ•´æå–ï¼‰
- **é€‚åº”ç—‡å…³ç³»**: ~200,000+
- **å­˜å‚¨ç©ºé—´**: ~1.5GBï¼ˆraw + processedï¼‰
